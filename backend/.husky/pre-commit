#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Run linting
echo "ğŸ“ Running ESLint..."
npm run lint --silent || {
  echo "âŒ ESLint failed. Please fix the errors above."
  exit 1
}

# Check for console.log statements (should use logger instead)
echo "ğŸ” Checking for console.log statements..."
if grep -r "console\.log" --include="*.js" --exclude-dir=node_modules --exclude-dir=coverage .; then
  echo "âš ï¸  Warning: Found console.log statements. Consider using logger instead."
  echo "Do you want to continue? (y/n)"
  read -r response
  if [ "$response" != "y" ]; then
    exit 1
  fi
fi

# Run tests (quick unit tests only)
echo "ğŸ§ª Running quick tests..."
npm run test:unit --silent || {
  echo "âŒ Tests failed. Please fix the errors above."
  exit 1
}

echo "âœ… Pre-commit checks passed!"
